<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Akladell</title>
        <link rel="stylesheet" type="text/css" href="main.css">

    </head>
<body>
    <div class="centered-container">
        <header>
            <h1>Akladell</h1>
        </header>
        <div class="flex-grow">
            <nav>
                <div class="nav-items">
                    <a href="#Home">Home</a>
                    <a href="#Rules">Rules Index</a>
                    <a href="#Updates">Updates</a>
                    <a href="#About">About</a>
                    <a href="#Discord" id="discordlink">Discord</a>
                </div>
            </nav>
            <div id="toc-wrapper">
                <div id="toc-panel">
                    <h2>Table of Contents</h2>
                    <ul>
                        <li><a href="#Quick-Creation-Reference">Quick Creation Reference</a></li>
                        <li><a href="#Character-Creation">Character Creation</a></li>
                        <li><a href="#Ability-Scores">Ability Scores</a></li>
                        <li><a href="#Races">Races</a></li>
                        <li><a href="#Classes">Classes</a></li>
                        <li><a href="#Languages">Languages</a></li>
                        <li><a href="#Alignment">Alignment</a></li>
                        <li><a href="#General-Gameplay">General Gameplay</a></li>
                        <li><a href="#Combat">Combat</a></li>
                        <li><a href="#Injury-&-Death">Injury & Death</a></li>
                        <li><a href="#Creature-Size">Creature Size</a></li>
                        <li><a href="#Time">Time</a></li>
                        <li><a href="#Sanity">Sanity</a></li>
                        <li><a href="#Retainers">Retainers</a></li>
                        <li><a href="#Encumbrance-&-Movement">Encumbrance & Movement</a></li>
                        <li><a href="#Multiclassing">Multiclassing</a></li>
                        <li><a href="#Spellcasting">Spellcasting</a></li>
                        <li><a href="#Psionics">Psionics</a></li>
                        <li><a href="#Items">Items</a></li>
                        <li><a href="#Spells">Spells</a></li>
                        <li><a href="#Spell-Descriptions">Spell Descriptions</a></li>
                        <li><a href="#Sources">Sources</a></li>
                    </ul>
                </div>
                <div id="content"></div>
            </div>
        </div>
        <footer><hr></footer>
    </div>


<script type="module">
    import { marked } from '//cdn.jsdelivr.net/npm/marked/lib/marked.esm.js';

    function handleTocClick(e) 
    {
    e.preventDefault();
    const hash = this.getAttribute('href');
    window.location.hash = hash; // Update URL hash
    window.loadRulesPage(hash);
    }

    const tocLinks = document.querySelectorAll('#toc-panel a');
    tocLinks.forEach(link => {
    link.addEventListener('click', handleTocClick);
    });

    window.loadRulesPage = function(hash)
    {
    fetch('./rules.md')
    .then(response => response.text())
    .then(data => {
        const htmlContent = marked.parse(data);
        document.getElementById('content').innerHTML = `<div class='rules-content'>${htmlContent}</div>`;
        if (hash) 
        {
        scrollToHash(hash);
        }
    });
    }

    function scrollToHash(hash) 
    {
    hash = String(hash).replace('#', ''); // Convert hash to string first
    const el = document.getElementById(hash);
    if (el) {
        el.scrollIntoView();
    }
    }


    document.addEventListener("DOMContentLoaded", function()
    {
    const tocPanel = document.getElementById('toc-panel');

    window.onhashchange = function() 
    {
    var hash = window.location.hash.substring(1);
    if(hash === 'Home') 
    {
        loadHomePage();
    } 
    else if(hash === 'Updates') 
    {
        loadUpdatePost();
    } 
    else if(hash === 'About') 
    {
        loadAboutPage();
    }
    else if(hash === 'Discord') 
    {

    } 
    else 
    {
        window.loadRulesPage();
    }
};

if (window.location.hash) 
{
    // Manually trigger hashchange event if there's already a hash in the URL
    window.dispatchEvent(new Event('hashchange'));
} 
else 
{
    window.location.hash = "#Home";
}

window.addEventListener('hashchange', scrollToHash);
    // Trigger first hashchange check after all setup has been done.
    window.dispatchEvent(new Event('hashchange'));
});
</script>

    <script src='app.js'></script>

    <noscript>You need to enable JavaScript to view the full site.</noscript>
</body>
</html>
